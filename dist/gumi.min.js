!function(t,e,i,s){var n={buttonClass:"gumi-btn-default",buttonSelectedClass:"gumi-btn-selected",buttonDisabledClass:"gumi-btn-disabled",optionDisabledClass:"gumi-option-disabled",dropdownClass:"gumi-dropdown-default",buttonTextOnly:!0,onChange:function(){},onOpen:function(){},onCancel:function(){this.reset()}},o=function(e,i){this.options=t.extend({},n,i),this._load=!0,this.fromNativeSelect=!1,this._createElement(e),this._createButton(),this._createDropdown(),this._createSelect(),this.selectedIndex=0,this.selectedLabel=s,this.selectedValue=s,this._defaults=n,this._initialSelected=s,this._init()};o.prototype={constructor:o,_init:function(){this._bindDropdown(),this._bindSelectOption(),this._load=!1},_createElement:function(e){var i=t(e);i.is("select")?(this.fromNativeSelect=!0,this.$select=i,this.$elem=t("<div/>"),this.elem=i[0],this.$elem.data("gumi",this).insertBefore(this.$select)):(this.$elem=i,this.elem=e),this.$elem.addClass("gumi-wrap")},_createButton:function(){this.$button=this.$elem.find("button");var e=t("<span><em></em></span>");this.$button.length||(this.$button=t("<button />")),this.$button.addClass("gumi-btn").addClass(this.options.buttonClass),this.$button.attr("data-arrow-icn")&&this.$button.data("arrow-icn")!==!0||e.append('<i class="icn arrow-down">&nbsp;</i>'),this.fromNativeSelect?this.$button.append(e):(this.$button.data("cancel-icn")&&this.selectedIndex!=this._initialSelected&&e.append('<i class="icn cancel-icn js-gumi-cancel">&nbsp;</i>'),this.$button.data("default-value")||this.$button.empty().append(e),this._updateButton())},_updateButton:function(){this.$button.toggleClass(this.options.buttonDisabledClass,this.$button.data("disabled")===!0)},_createSelect:function(){this.fromNativeSelect?this.$select.hide():this._buildSelect(),this.$elem.append(this.$select)},_buildSelect:function(){var e=this,i=0;return this.$select=t("<select/>"),this.$select.data("gumi",this).addClass(this.options.dropdownClass).addClass(this.$button.data("class")).attr("name",this.$button.data("name")).prop("required",this.$button.data("required")).hide(),this._deserializeParams(),this.$elem.find("li").each(function(n){var o=t(this),a=o.data("value"),l=a===s&&""!==a?o.html():String(a),d=o.data("label")||o.html()||l;o.data("selected")===!0&&(i=n),o.toggleClass(e.options.optionDisabledClass,o.data("disabled")===!0),o.toggle(o.data("selectable")!==!1),t("<option />").val(l).append(d).addClass(o.attr("class")).appendTo(e.$select)}),this._initialSelected=i,this.setSelectedOption(i,!0),i},_createDropdown:function(){this.fromNativeSelect?this._buildDropdown():this.$dropdown=this.$elem.find("ul"),this.$elem.prepend(this.$button),this.$dropdown.hide().addClass("gumi-dropdown").addClass(this.options.dropdownClass)},_buildDropdown:function(){var e=this;this.$dropdown=t("<ul/>"),this.$select.find("option").each(function(){var i=t(this),s=t("<li/>");s.html(i.text()),e.$dropdown.append(s),i.prop("disabled")&&(s.hide(),i.prop("selected")&&e.$button.find("span em").html(i.text()))}),this.$elem.append(this.$dropdown)},_bindDropdown:function(){var e=this;this.$button.on("click.Gumi",function(i){if(i.preventDefault(),i.stopPropagation(),e._resetDropdowns(e.$elem),!t(this).data("disabled")){if(t(i.target).hasClass("js-gumi-cancel"))return void e.options.onCancel.call(e);e.$button.toggleClass(e.options.buttonSelectedClass),e.$dropdown.toggle(),e.$dropdown.is(":visible")&&e.options.onOpen.call(e.$elem)}}),t(i).off("click.Gumi"),t(i).on("click.Gumi",function(i){0===t(i.target).closest(".gumi-dropdown").length&&e._resetDropdowns()})},_bindSelectOption:function(){var e=this;e.$dropdown.on("click.Gumi","li",function(i){var s=t(this);i.stopPropagation(),s.data("disabled")||(e.setSelectedOption(s.index()),e.closeDropdown())})},_resetDropdowns:function(e){t(".gumi-wrap").not(e).each(function(){t(this).data("gumi").closeDropdown()})},_deserializeParams:function(){var t=this.$button.data("params"),e={};if(t&&"string"==typeof t){t=t.split(" ");for(var i,s=0,n=t.length;n>s;s++)i=t[s].split("="),e[i[0]]=i[1];this._addDataToSelect(e)}},_addDataToSelect:function(t){for(var e in t)this.$select.data(e,t[e])},update:function(){this._updateButton()},setSelected:function(t,e){var i=this.$select.find('option[value="'+t+'"]');i.length&&this.setSelectedOption(i.index(),e)},setSelectedOption:function(t,e){t=t||0;var i=this.$select.find("option").eq(t);this.selectedIndex=t,this.selectedLabel=this.$dropdown.eq(t).data("label")||(this.options.buttonTextOnly?i.text():i.html()),this.selectedValue=i.val(),i.prop("selected",!0),e||(i.trigger("change"),this.options.onChange.call(this.$select)),(this._load===!1&&this.$button.data("no-change")!==!0||this._load===!0&&!this.$button.data("default-value"))&&this.$button.find("span em").html(this.selectedLabel)},onEvent:function(t,e){"function"==typeof e&&this.options[t]&&(this.options[t]=e)},closeDropdown:function(){this.$button.removeClass(this.options.buttonSelectedClass),this.$dropdown.hide()},reset:function(){this.setSelectedOption(this._initialSelected)},val:function(){return this.selectedValue}},t.fn.gumi=function(e){var i=arguments,s=this;return this.each(function(n){var a=t.data(this,"gumi");a?"string"==typeof e&&"function"==typeof a[e]&&a[e].apply(a,Array.prototype.slice.call(i,1)):(t.data(this,"gumi",new o(this,e)),n===s.length-1&&t(this).trigger("ready.Gumi"))})}}(jQuery,window,document);